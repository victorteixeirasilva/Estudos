REM   Script: DIO - MySQL - Consultas com JOIN
REM   CURSO DA DIO COM MySQL, SOBRE CONSULTAS COM JOIN

CREATE TABLE CANAIS ( 
    ID_CANAL    NUMBER(11)      NOT NULL 
   ,NOME_CANAL  VARCHAR(100)    NOT NULL 
);

INSERT INTO CANAIS (ID_CANAL, NOME_CANAL) 
  VALUES    (1, 'React') 
           ,(2, 'PHP') 
           ,(3, 'CSS') 
           ,(4, 'HTML') ;

INSERT INTO CANAIS (ID_CANAL, NOME_CANAL) 
  VALUES (1, 'React') ;

INSERT INTO CANAIS (ID_CANAL, NOME_CANAL) 
  VALUES (3, 'CSS') ;

INSERT INTO CANAIS (ID_CANAL, NOME_CANAL) 
  VALUES (2, 'PHP') ;

INSERT INTO CANAIS (ID_CANAL, NOME_CANAL) 
  VALUES (4, 'HTML') ;

CREATE TABLE VIDEOS( 
    ID_VIDEO    NUMBER(11)      NOT NULL 
   ,NOME_VIDEO  VARCHAR(100)    NOT NULL 
   ,AUTOR_VIDEO VARCHAR(100)    NOT NULL 
);

INSERT INTO VIDEOS(ID_VIDEO, NOME_VIDEO, AUTOR_VIDEO) 
  VALUES(1, 'LOGIN COM REACT', 'React') ;

INSERT INTO VIDEOS(ID_VIDEO, NOME_VIDEO, AUTOR_VIDEO) 
  VALUES(2, 'COMPONENTES COM REACT', 'React') ;

INSERT INTO VIDEOS(ID_VIDEO, NOME_VIDEO, AUTOR_VIDEO) 
  VALUES(3, 'LISTAS COM PHP', 'PHP') ;

INSERT INTO VIDEOS(ID_VIDEO, NOME_VIDEO, AUTOR_VIDEO) 
  VALUES(4, 'FUNÇÕES COM PHP', 'PHP') ;

INSERT INTO VIDEOS(ID_VIDEO, NOME_VIDEO, AUTOR_VIDEO) 
  VALUES(5, 'PÁGINAS COM HTML', 'HTML') ;

CREATE TABLE VIDEO_CANAIS ( 
    ID_CANAIS_VIDEO     NUMERIC(11)     NOT NULL 
   ,FK_CANAL            NUMERIC(11)     NOT NULL 
   ,FK_VIDEO            NUMERIC(11)     NOT NULL 
);

INSERT INTO VIDEO_CANAIS (ID_CANAIS_VIDEO, FK_CANAL, FK_VIDEO) 
  VALUES (5, 4, 5) ;

INSERT INTO VIDEO_CANAIS (ID_CANAIS_VIDEO, FK_CANAL, FK_VIDEO) 
  VALUES (1, 2, 4) ;

INSERT INTO VIDEO_CANAIS (ID_CANAIS_VIDEO, FK_CANAL, FK_VIDEO) 
  VALUES (2, 2, 3) ;

INSERT INTO VIDEO_CANAIS (ID_CANAIS_VIDEO, FK_CANAL, FK_VIDEO) 
  VALUES (3, 1, 1) ;

INSERT INTO VIDEO_CANAIS (ID_CANAIS_VIDEO, FK_CANAL, FK_VIDEO) 
  VALUES (4, 1, 2) ;

ALTER TABLE CANAIS 
 ADD CONSTRAINT PK_CANAIS PRIMARY KEY (ID_CANAL) ;

ALTER TABLE VIDEOS 
  ADD CONSTRAINT PK_VIDEOS PRIMARY KEY (ID_VIDEO) ;

ALTER TABLE VIDEO_CANAIS 
  ADD CONSTRAINT PK_VIDEO PRIMARY KEY (ID_CANAIS_VIDEO) ;

CREATE SEQUENCE SQ_CANAIS START WITH 6 INCREMENT BY 1 NOCACHE NOCYCLE;


CREATE SEQUENCE SQ_VIDEOS START WITH 6 INCREMENT BY 1 NOCACHE NOCYCLE;


CREATE SEQUENCE SQ_VIDEO_CANAIS START WITH 6 INCREMENT BY 1 NOCACHE NOCYCLE;


ALTER TABLE VIDEO_CANAIS
  ADD CONSTRAINT FK_CANAL FOREIGN KEY (FK_CANAL) REFERENCES CANAIS (ID_CANAL)
;



ALTER TABLE VIDEO_CANAIS
  ADD CONSTRAINT FK_VIDEO FOREIGN KEY (FK_VIDEO) REFERENCES VIDEOS (ID_VIDEO)
;


SELECT * FROM VIDEO_CANAIS;


SELECT *
  FROM VIDEO_CANAIS VC JOIN VIDEOS V
    ON VC.FK_CANAL = V.ID_VIDEO
;


SELECT *
  FROM VIDEO_CANAIS VC
    JOIN VIDEOS V
      ON VC.FK_VIDEO = V.ID_VIDEO
    JOIN CANAIS C
      ON VC.FK_CANAL = C.ID_CANAL
;



SELECT
    V.NOME_VIDEO
   ,V.AUTOR_VIDEO
   ,C.NOME_CANAL
  FROM VIDEO_CANAIS VC
    JOIN VIDEOS V
      ON VC.FK_VIDEO = V.ID_VIDEO
    JOIN CANAIS C
      ON VC.FK_CANAL = C.ID_CANAL
;



SELECT
    V.NOME_VIDEO
   ,V.AUTOR_VIDEO
   ,C.NOME_CANAL
  FROM VIDEO_CANAIS VC
    RIGHT JOIN VIDEOS V
      ON VC.FK_VIDEO = V.ID_VIDEO
    RIGHT JOIN CANAIS C
      ON VC.FK_CANAL = C.ID_CANAL
;



SELECT 
    V.ID_VIDEO
   ,V.NOME_VIDEO
  FROM VIDEOS V
    LEFT JOIN VIDEO_CANAIS VC
      ON V.ID_VIDEO = VC.FK_VIDEO
 UNION
SELECT
    C.ID_CANAL
   ,C.NOME_CANAL
  FROM VIDEO_CANAIS VC
    RIGHT JOIN CANAIS C
      ON VC.FK_CANAL = C.ID_CANAL
;



SELECT
    V.NOME_VIDEO
   ,V.AUTOR_VIDEO
   ,C.NOME_CANAL
  FROM VIDEO_CANAIS VC
    JOIN VIDEOS V
      ON VC.FK_VIDEO = V.ID_VIDEO
    JOIN CANAIS C
      ON VC.FK_CANAL = C.ID_CANAL
  WHERE C.ID_CANAL = 2
;



